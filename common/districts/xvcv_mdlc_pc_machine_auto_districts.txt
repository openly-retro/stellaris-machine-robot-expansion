# City district serves gestalt and individual machines now
xvcv_mdlc_pc_machine_auto_district_city = {
	base_buildtime = @xvcv_mdlc_district_time_3
	is_uncapped = {}
	default_starting_district = yes

	zone_slots = {
		slot_city_government
		slot_city_01
		slot_city_02
	}

	show_on_uncolonized = {
		exists = from
		from = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
			# has_auth_machine_intelligence = no
			has_oxr_mdlc_origin_world_machine_awakened = no
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
			# has_auth_machine_intelligence = no
			has_oxr_mdlc_origin_world_machine_awakened = no
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	inline_script = planet/districts/convert_to/oxr_wm_district_primary

	resources = {
		category = xvcv_mdlc_world_machines_cities_districts
		cost = {
			minerals = @xvcv_mdlc_district_cost_3
		}
		upkeep = { energy = 2 }
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_machine_intelligence }
			}
		}
		planet_housing_add = 1000
		planet_amenities_add = 1200
	}
	# Gestalts
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_authority = auth_machine_intelligence
			}
		}
		planet_housing_add = 1100
		planet_amenities_no_happiness_add = 1200
	}

	# Copy triggered modifiers from "district_city"
	inline_script = planet/districts/vanilla/oxr_city_filler

	on_built = {
		inline_script = planet/districts/on_action/on_wm_district_built
	}
	on_destroy = {
		inline_script = planet/districts/on_action/on_wm_district_destroy
	}

	# name swaps
	triggered_name = {
		trigger = {
			exists = owner
			owner = {
				has_xvcv_mdlc_ap_world_machines = yes
				has_authority = auth_machine_intelligence
				has_oxr_mdlc_origin_world_machine_awakened = no
			}
		}
		text = xvcv_mdlc_pc_machine_auto_district_nexus
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_xvcv_mdlc_ap_world_machines = yes
				has_authority = auth_machine_intelligence
				has_oxr_mdlc_origin_world_machine_awakened = no
			}
		}
		text = xvcv_mdlc_pc_machine_auto_district_nexus_desc
	}
}

xvcv_mdlc_pc_machine_auto_district_primary_origin_wm = {
	base_buildtime = @xvcv_mdlc_district_time_3
	is_uncapped = {}
	default_starting_district = yes

	zone_slots = {
		oxr_mdlc_origin_wm_slot_city_government
		oxr_mdlc_origin_wm_slot_city_01
		oxr_mdlc_origin_wm_slot_city_02
	}

	show_on_uncolonized = {
		exists = from
		from = { has_oxr_mdlc_origin_world_machine_awakened = yes }
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = { has_oxr_mdlc_origin_world_machine_awakened = yes }
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	inline_script = planet/districts/convert_to/oxr_wm_district_primary

	resources = {
		category = xvcv_mdlc_world_machines_primary_districts
		cost = {
			minerals = @xvcv_mdlc_district_cost_3
		}
		upkeep = { energy = @xvcv_mdlc_pc_machine_auto_district_industrial_upkeep }
	}

	ai_resource_production = {
		alloys = 10
		trigger = { always = yes }
	}
	ai_resource_production = {
		consumer_goods = 10
		trigger = {
			owner = {
				OR = {
					country_uses_consumer_goods = yes
					has_valid_civic = xvcv_mdlc_civic_goods_distributor
				}
			}
		}
	}

	on_built = {
		inline_script = planet/districts/on_action/on_wm_district_built
	}
	on_destroy = {
		inline_script = planet/districts/on_action/on_wm_district_destroy
	}
}

xvcv_mdlc_pc_machine_auto_district_generator = {
	base_buildtime = @xvcv_mdlc_district_time_2
	is_uncapped = {}

	zone_slots = {
		oxr_mdlc_origin_wm_slot_energy
	}

	show_on_uncolonized = {
		exists = from
		from = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	inline_script = planet/districts/convert_to/oxr_wm_district_2

	# produces
	resources = {
		category = xvcv_mdlc_world_machines_generator_districts
		inline_script = {
			script = planet/districts/auto/oxr_mdlc_generator
			JOBS = 2
		}
	}
	triggered_desc = {
		trigger = {
			has_active_building = rikk_mdlc_world_machine_SR_building
		}
		text = xvcv_mdlc_generator_district_motes_produces
	}
	inline_script = planet/buildings/auto/oxr_auto_biofuel

	ai_resource_production = {
		energy = 20
		trigger = { always = yes }
	}
	on_built = {
		inline_script = planet/districts/on_action/on_wm_district_built
	}
	on_destroy = {
		inline_script = planet/districts/on_action/on_wm_district_destroy
	}
	triggered_name = {
		trigger = {
			has_oxr_mdlc_zone_wm_energy_physics = yes
		}
		text = xvcv_mdlc_pc_machine_auto_district_generator_triggered_name_energy_physics
	}
	triggered_name = {
		trigger = {
			has_rikk_mdlc_zone_gas_generator = yes
		}
		text = xvcv_mdlc_pc_machine_auto_district_generator_triggered_name_gas_generator
	}
	triggered_name = {
		text = xvcv_mdlc_pc_machine_auto_district_generator_triggered_name_none
	}
	# triggered_flavor_desc = {
	# 	trigger = { has_oxr_mdlc_zone_wm_energy_physics = yes }
	# 	text = xvcv_mdlc_pc_machine_auto_district_generator_triggered_desc_energy_physics
	# }
	# triggered_flavor_desc = {
	# 	text = xvcv_mdlc_pc_machine_auto_district_generator_desc
	# }
}

xvcv_mdlc_pc_machine_auto_district_mining = {
	base_buildtime = @xvcv_mdlc_district_time_2
	is_uncapped = {}

	zone_slots = {
		oxr_mdlc_origin_wm_slot_minerals
	}

	show_on_uncolonized = {
		exists = from
		from = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	inline_script = planet/districts/convert_to/oxr_wm_district_3

	resources = {
		category = xvcv_mdlc_world_machines_mining_districts
		cost = {
			minerals = @xvcv_mdlc_district_cost_2
		}
		produces = {
			minerals = @[ 2 * oxr_mdlc_wm_base_miner_output ]
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_efficiency|
		}
		produces = { 
			trigger = {
				exists = owner
				owner = {
					has_tradition = tr_nanotech_1
				}
			}
			nanites = @[ 2 * oxr_mdlc_wm_base_drone_nanite_output ]
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_efficiency|
		}
		upkeep = { 
			energy = @xvcv_mdlc_pc_machine_auto_district_mining_upkeep  # 2 drones * 1, plus 1 base district upkeep 
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_efficiency|
		}
		produces = {
			trigger = {
				has_building = oxr_mdlc_world_machines_building_auto_mining_support
			}
			minerals = 1
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_efficiency|
		}
		produces = {
			trigger = {
				has_building = oxr_mdlc_world_machines_building_auto_mining_support
			}
			minerals = 2
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_efficiency|
		}
	}
	triggered_desc = {
		trigger = {
			has_active_building = rikk_mdlc_world_machine_SR_building
		}
		text = xvcv_mdlc_mining_district_crystals_produces
	}

	ai_resource_production = {
		minerals = 10
		trigger = { always = yes }
	}
	on_built = {
		inline_script = planet/districts/on_action/on_wm_district_built
	}
	on_destroy = {
		inline_script = planet/districts/on_action/on_wm_district_destroy
	}
	triggered_name = {
		trigger = {
			has_oxr_mdlc_zone_wm_minerals_engineering = yes
		}
		text = xvcv_mdlc_pc_machine_auto_district_mining_triggered_name_minerals_engineering
	}
	triggered_name = {
		trigger = {
			has_rikk_mdlc_zone_crystalline_scanning = yes
		}
		text = xvcv_mdlc_pc_machine_auto_district_mining_triggered_name_crystalline_scanning
	}
	triggered_name = {
		text = xvcv_mdlc_pc_machine_auto_district_generator_triggered_name_none
	}
}

xvcv_mdlc_pc_machine_auto_district_farming = {
	base_buildtime = @xvcv_mdlc_district_time_2
	is_uncapped = {}

	zone_slots = {
		oxr_mdlc_origin_wm_slot_food
	}

	show_on_uncolonized = {
		exists = from
		from = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}
	potential = {
		exists = owner
		owner = {
			oxr_mdlc_planet_owner_can_build_wm_districts = yes
		}
		uses_district_set = xvcv_mdlc_pc_machine_auto_district_set
	}

	conversion_ratio = 1
	inline_script = planet/districts/convert_to/oxr_wm_district_4

	resources = {
		category = xvcv_mdlc_world_machines_food_districts
		cost = {
			minerals = @xvcv_mdlc_district_cost_2
		}
		produces = {
			food = @[ 2 * oxr_mdlc_wm_base_farmer_output ]
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_efficiency|
		}
		produces = {
			trigger = {
				exists = owner
				owner = { has_tradition = tr_nanotech_1 }
			}
			nanites = @[ 2 * oxr_mdlc_wm_base_drone_nanite_output ]
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_efficiency|
		}
		upkeep = { 
			energy = @xvcv_mdlc_pc_machine_auto_district_farming_upkeep
			mult = value:scripted_modifier_mult|MODIFIER|rikk_mdlc_world_machine_districts_efficiency|
		}
	}
	triggered_desc = {
		trigger = {
			has_active_building = rikk_mdlc_world_machine_SR_building
		}
		text = xvcv_mdlc_food_district_gas_produces
	}

	ai_resource_production = {
		food = 10
		trigger = { always = yes }
	}
	on_built = {
		inline_script = planet/districts/on_action/on_wm_district_built
	}
	on_destroy = {
		inline_script = planet/districts/on_action/on_wm_district_destroy
	}
	triggered_name = {
		trigger = {
			has_oxr_mdlc_zone_wm_food_biology = yes
		}
		text = xvcv_mdlc_pc_machine_auto_district_farming_triggered_name_food_biology
	}
	triggered_name = {
		trigger = {
			has_rikk_mdlc_zone_mote_fertilizing = yes
		}
		text = xvcv_mdlc_pc_machine_auto_district_farming_triggered_name_mote_fertilizing
	}
	triggered_name = {
		text = xvcv_mdlc_pc_machine_auto_district_generator_triggered_name_none
	}
}

### SWAPS ###
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_foundry = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_industrial
	overlay_icon = GFX_district_alloys
	gridbox = district_industrial
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_factory = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_industrial
	overlay_icon = GFX_district_consumer_goods
	gridbox = district_industrial
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_archive = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_unity
	overlay_icon = GFX_rikk_mdlc_wm_district_archive
	gridbox = rikk_mdlc_pc_machine_auto_district_unity
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_research = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_science
	overlay_icon = GFX_district_research
	gridbox = district_research
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_physics = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_science
	overlay_icon = GFX_district_physics
	gridbox = district_research
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_society = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_science
	overlay_icon = GFX_district_society
	gridbox = district_research
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_engineering = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_science
	overlay_icon = GFX_district_engineering
	gridbox = district_research
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_unity = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_unity
	overlay_icon = GFX_district_unity
	gridbox = rikk_mdlc_pc_machine_auto_district_unity
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_trade = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm
	overlay_icon = GFX_district_trade
	gridbox = district_arcology_trade
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_army = {
	base_buildtime = @xvcv_mdlc_district_time_3
	icon = xvcv_mdlc_pc_machine_auto_district_primary_origin_wm_army
	overlay_icon = GFX_district_fortress
	gridbox = district_arcology_fortress
	inline_script = { script = planet/districts/rikk_wm_swap_base }
}
