# Situations for the civic planet_eaters
# Generally:
# Stage 1: "relocate" pops, if they exist; player decides how
# Stage 2: process atmosphere (can generate a few resources at this stage)
# Stage 3: process crust (most food comes from this stage)
# Stage 4: process mantle (minerals, rare crystals, some alloys)
# Stage 5: Cool down core for processing with heat siphon (can generate energy with relevant tech)
# Stage 6: Core processing (generate alloys)
# Stage 7: Clean up

oxr_mdlc_situation_planet_decomposer_mega = {
	# Ideally I want the length of this situation
	# To be some factor of the planet's size
	# For ex: I want a size 30 planet to take 60 years to rip apart, by default 
	picture = GFX_evt_continental
	complete_icon_frame = GFX_situation_outcome_frame_green
	complete_icon = GFX_situation_outcome_positive
	stages = {
		# Deal with pops
		oxr_mdlc_situation_planet_decomposer_mega_stage_1 = {
			# Pick/make some kind of pops-related icon
			icon = GFX_xvcv_mdlc_situation_stage_1
			icon_background = GFX_situation_stage_frame_green
            end = target.oxr_mdlc_planet_decomposer_situation_stage_1
			on_first_enter = {
				if = {
					limit = {
						target = {
							is_colony = no
						}
					}
					# Effect to skip/complete this stage
				}
			}
		}

		# Atmosphere
		oxr_mdlc_situation_planet_decomposer_mega_stage_2 = {
			icon = GFX_xvcv_mdlc_situation_stage_2
			icon_background = GFX_situation_stage_frame_green
            end = target.oxr_mdlc_planet_decomposer_situation_stage_2
			on_first_enter = {
				if = {
					limit = {
						target = {
							is_planet_class = pc_barren
						}
					}
					# Effect to skip/complete this stage, barren has no atmosphere?
				}
			}
		}

		# Crust
		oxr_mdlc_situation_planet_decomposer_mega_stage_3 = {
			icon = GFX_xvcv_mdlc_situation_stage_3
			icon_background = GFX_situation_stage_frame_green
            end = target.oxr_mdlc_planet_decomposer_situation_stage_3
		}

		# Mantle
		oxr_mdlc_situation_planet_decomposer_mega_stage_4 = {
			icon = GFX_xvcv_mdlc_situation_stage_4
			icon_background = GFX_situation_stage_frame_green
            end = target.oxr_mdlc_planet_decomposer_situation_stage_4
		}

		# Core cooling
		oxr_mdlc_situation_planet_decomposer_mega_stage_5 = {
			icon = GFX_xvcv_mdlc_situation_stage_5
			icon_background = GFX_situation_stage_frame_green
            end = target.oxr_mdlc_planet_decomposer_situation_stage_5
			on_first_enter = {
				if = {
					limit = {
						target = {
							is_planet_class = pc_frozen
						}
					}
					# Effect to skip/complete this stage, barren has no atmosphere?
				}
			}
		}

		# Core
		oxr_mdlc_situation_planet_decomposer_mega_stage_6 = {
			icon = GFX_xvcv_mdlc_situation_stage_6
			icon_background = GFX_situation_stage_frame_green
            end = target.oxr_mdlc_planet_decomposer_situation_stage_6
		}

		# Cleanup
		oxr_mdlc_situation_planet_decomposer_mega_stage_7 = {
			icon = GFX_xvcv_mdlc_situation_stage_7
			icon_background = GFX_situation_stage_frame_green
            end = target.oxr_mdlc_planet_decomposer_situation_stage_7
		}
	}
    monthly_progress = {
        base = 30  # 30 days per month ...
    }

	## For all stages
	# Do nothing / pause
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_approach_pause
		icon = GFX_situation_approach_suspicious
		icon_background = GFX_situation_approach_bg_blue
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_approach_pause_tooltip
		}
	}

	## Stage 1 approaches
	# Relocate home
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_approach_pops_relocate_home
		icon = GFX_situation_approach_suspicious
		icon_background = GFX_situation_approach_bg_blue
		allow = {
			current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_1
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_approach_pops_relocate_home_tooltip
		}
	}
	# Displace
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_approach_pops_displace
		icon = GFX_situation_approach_suspicious
		icon_background = GFX_situation_approach_bg_blue
		allow = {
			current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_1
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_approach_pops_displace_tooltip
		}
	}
	# Do bad things ...
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_approach_pops_purge
		icon = GFX_situation_approach_suspicious
		icon_background = GFX_situation_approach_bg_blue
		allow = {
			current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_1
			owner = {
				# or they have any species policy set to purge
				oxr_mdlc_is_machine_terminator = yes
			}
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_approach_pops_purge_tooltip
		}
	}

    ## Stages 2,3,4,6
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_approach_pause
		icon = GFX_situation_approach_suspicious
		icon_background = GFX_situation_approach_bg_blue
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_approach_pause_tooltip
		}
	}
	# Standard approach
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_approach_standard
		icon = GFX_situation_approach_balance_sheet
		icon_background = GFX_situation_approach_bg_green
		allow = {
			NOT = { current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_1 }
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_approach_standard_tooltip
		}
	}

	# Slow, but more efficient
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_approach_refinement
		icon = GFX_situation_approach_minerals
		icon_background = GFX_situation_approach_bg_yellow
		allow = {
			NOT = { current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_1 }
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_approach_refinement_tooltip
		}
	}

	# Fast, but less efficient
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_approach_careless
		icon = GFX_situation_approach_energy_credits
		icon_background = GFX_situation_approach_bg_red
		allow = {
			NOT = { current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_1 }
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_approach_careless_tooltip
		}
	}

	## Stage 7: Cleanup
	# Make things politically easier
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_stage_7_pay_influence
		icon = GFX_situation_approach_energy_credits
		icon_background = GFX_situation_approach_bg_red
		allow = {
			current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_7
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_stage_7_pay_influence_tooltip
		}
	}
	# "Bribes"
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_stage_7_share_wealth
		icon = GFX_situation_approach_energy_credits
		icon_background = GFX_situation_approach_bg_red
		allow = {
			current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_7
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_stage_7_share_wealth_tooltip
		}
	}
	# Apolitical
	approach = {
		name = oxr_mdlc_situation_planet_decomposer_mega_stage_7_ignore_consequences
		icon = GFX_situation_approach_energy_credits
		icon_background = GFX_situation_approach_bg_red
		allow = {
			current_stage = oxr_mdlc_situation_planet_decomposer_mega_stage_7
		}
		on_select = {
			custom_tooltip = oxr_mdlc_situation_planet_decomposer_mega_stage_7_ignore_consequences_tooltip
		}
	}
}
